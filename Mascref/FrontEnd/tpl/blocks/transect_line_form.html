<div class="panel panel-default">
  <div class="panel-body">
    <div class="form-group">
      <label class="col-sm-2">Data recorded by</label>
      <div class="col-sm-4">
        <i ng-show="loadingResearchers" class="fa fa-spinner fa-spin form-control-spin"></i>
        <input type="text" class="form-control w-xxl" ng-model="transect.line.recorded_by" placeholder="Search researchers in the system" uib-typeahead="researcher as researcher.name for researcher in getResearchers($viewValue)" uib-typeahead-loading="loadingResearchers">
      </div>
    </div>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-body">    
    <div class="row table-responsive">
      <table class="table table-striped b-t b-light text-sm">
        <thead>
          <tr>
            <th style="width:20px;">Code</th>
            <th>Name</th>
            <th class="text-center" ng-repeat="seg in [0,1,2,3]">S{{seg+1}}</th>
            <th>Total</th>
            <th>Mean Count</th>  
            <th class="text-center" ng-repeat="seg in [0,1,2,3]">% S{{seg+1}}</th>
            <th>Mean % segment</th>              
            <th>SD (%)</th>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="lGroup in line_groups" ng-init="totals[lGroup.name] = []; totals_percentage[lGroup.name] = []">
            <th>{{lGroup.name}}</th>
            <td>{{lGroup.description}}</td>
            <td class="text-center" ng-repeat="seg in [0,1,2,3]">{{totals[lGroup.name][seg] = (transect.line.data[seg] | filter:lGroup.name:strict).length}}</td>
            <th class="text-center">{{totals[lGroup.name] | sum }}</th>
            <td class="text-center">{{totals[lGroup.name] | mean | number:MASCREF_CONF.SIGNIFICANT_DIGITS}}</td>
            <td class="text-center" ng-repeat="seg in [0,1,2,3]">{{totals_percentage[lGroup.name][seg] = (totals[lGroup.name][seg]/MASCREF_CONF.TRANSECT_SEGMENTS_POINTS*100 | number:MASCREF_CONF.SIGNIFICANT_DIGITS)}}</td>           
            <td class="text-center">{{totals_percentage[lGroup.name] | mean | number:MASCREF_CONF.SIGNIFICANT_DIGITS}}</td>
            <td class="text-center">{{totals_percentage[lGroup.name] | sd | number:MASCREF_CONF.SIGNIFICANT_DIGITS}}</td>
          </tr>
        </tbody>
        <tbody>
          <tr>
            <td></td>
            <td></td>
            <td class="text-center" ng-repeat="seg in [0,1,2,3]" ng-class="totals[seg] < MASCREF_CONF.TRANSECT_SEGMENTS_POINTS ? 'text-danger' : 'text-success'">{{totals[seg] = (transect.line.data[seg] | filter: { group_name:'!true'}).length}}</td>
            <td class="text-center" ng-class="total_seg < MASCREF_CONF.TRANSECT_SEGMENTS_POINTS*MASCREF_CONF.TRANSECT_SEGMENTS_TOTAL ? 'text-danger' : 'text-success'">{{total_seg = (seg | sum)}}</td>
            <td></td>              
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
            <td></td>
          </tr>
        </tbody>
      </table>
    </div>
    <div class="form-group">
      <label class="text-danger">Use the substrate codes above into the white boxes below</label>
    </div>
    <div class="form-inline">
      <div class="col-sm-3" ng-repeat="seg in [0,1,2,3]" ng-init="segStart = (MASCREF_CONF.TRANSECT_SEGMENTS_LENGTH+MASCREF_CONF.TRANSECT_SEGMENTS_SPACE)*seg" >
        <label class="col-sm-12 text-center">Segment {{seg+1}}</label>
        <label class="col-sm-12 text-center">{{segStart}} - {{segStart + MASCREF_CONF.TRANSECT_SEGMENTS_LENGTH-(MASCREF_CONF.TRANSECT_SEGMENTS_LENGTH/MASCREF_CONF.TRANSECT_SEGMENTS_POINTS)}} m</label>
        <div class="form-group form-inline col-sm-12 text-center" ng-repeat="n in [0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]"ng-init="point = (MASCREF_CONF.TRANSECT_SEGMENTS_LENGTH/MASCREF_CONF.TRANSECT_SEGMENTS_POINTS)*n+segStart">
          <div class="form-group">
            <label style="width:30px;">{{point | number:1 }}</label>
            <input ng-model="transect.line.data[seg][n].group_name" type="text" class="form-control input-sm inline v-middle text-center" uib-typeahead="group as group.name for group in line_groups | filter:{ name: $viewValue } " style="width:55px;" />
          </div>
          <div class="form-group">
            <label style="width:30px;">{{point + 10 | number:1 }}</label>
            <input ng-model="transect.line.data[seg][n+20].group_name" type="text" class="form-control input-sm inline v-middle text-center" uib-typeahead="group as group.name for group in line_groups | filter:{ name: $viewValue } " style="width:55px;" />
          </div> 
        </div>
      </div>       
    </div>
  </div>
</div>
<div class="panel panel-default">
  <div class="panel-body">
    <div class="form-group">
      <label class="col-sm-2 control-label">Comments</label>
      <div class="col-sm-8">
        <textarea class="form-control" rows="6" ng-model="transect.line.comments" placeholder="Type your commenys"></textarea>
      </div>
    </div>
  </div>
</div>
